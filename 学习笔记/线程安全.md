# 线程安全

## 什么事线程安全

> 当多个线程访问一个对象时，如果不用考虑这些线程在运行时环境下的调度和交替执行，也不需要进行额外的同步，或者在调用方进行任何其他的协调操作，调用这个对象的行为都可以获得正确的结果，那这个对象就是线程安全的。

## 三个核心概念

- 原子性

即一个操作（有可能包含有多个子操作）要么全部执行（生效），要么全部都不执行（都不生效）。

- 可见性

可见性是指，当多个线程并发访问共享变量时，一个线程对共享变量的修改，其它线程能够立即看到。

- 有序性

顺序性指的是，程序执行的顺序按照代码的先后顺序执行。

## 保证线程安全的方式

1. 使用线程安全的类(**`StringBuffer`**,**`AtomicInteger`**,**`ConcurrentHashMap`**)
2. 加锁(见[分布式锁](./分布式锁.md))

## 保证线程安全的方案

- 第一种 : 互斥同步 synchronized 
- 第二种：非阻塞同步
- 第三种：无同步方案 ThreadLocal

